cmake_policy(SET CMP0077 NEW)

set(MSDF_ATLAS_BUILD_STANDALONE OFF CACHE BOOL "" FORCE)
set(MSDF_ATLAS_USE_SKIA OFF CACHE BOOL "" FORCE)
set(MSDF_ATLAS_NO_ARTERY_FONT ON CACHE BOOL "" FORCE)

# msdfgen: force core-only build, no deps
set(MSDFGEN_CORE_ONLY ON CACHE BOOL "" FORCE)
set(MSDFGEN_BUILD_STANDALONE OFF CACHE BOOL "" FORCE)
set(MSDFGEN_USE_VCPKG OFF CACHE BOOL "" FORCE)
set(MSDFGEN_DISABLE_SVG ON CACHE BOOL "" FORCE)
set(MSDFGEN_DISABLE_PNG ON CACHE BOOL "" FORCE)
set(MSDFGEN_USE_SKIA OFF CACHE BOOL "" FORCE)

# SDL_mixer configuration (note: option names use SDLMIXER_*)
set(SDLMIXER_DEPS_SHARED OFF)
set(SDLMIXER_INSTALL OFF)
set(SDLMIXER_VENDORED ON)
set(SDLMIXER_FLAC_LIBFLAC OFF)
set(SDLMIXER_FLAC_DRFLAC ON)
set(SDLMIXER_GME OFF)
set(SDLMIXER_MOD_XMP OFF)
set(SDLMIXER_MP3_DRMP3 OFF)
set(SDLMIXER_MP3_MPG123 OFF)
set(SDLMIXER_MIDI_FLUIDSYNTH OFF)
set(SDLMIXER_MIDI_TIMIDITY OFF)
set(SDLMIXER_OPUS OFF)
# Prefer stb_vorbis to avoid libogg/libvorbis export issues
set(SDLMIXER_VORBIS_STB ON)
set(SDLMIXER_VORBIS_VORBISFILE OFF)
set(SDLMIXER_VORBIS_TREMOR OFF)
set(SDLMIXER_WAVPACK OFF)

if (CMAKE_SYSTEM_NAME MATCHES "Linux")
    set(SDL_VULKAN_ENABLED ON CACHE BOOL "")
endif()

if (WIN32)
    set(D3D12_AGILITY_SDK_ENABLED ON CACHE BOOL "")
endif()

add_subdirectory("${MW05_RECOMP_THIRDPARTY_ROOT}/msdf-atlas-gen")
add_subdirectory("${MW05_RECOMP_THIRDPARTY_ROOT}/nativefiledialog-extended")
add_subdirectory("${MW05_RECOMP_THIRDPARTY_ROOT}/o1heap")
add_subdirectory("${MW05_RECOMP_THIRDPARTY_ROOT}/SDL")
add_subdirectory("${MW05_RECOMP_THIRDPARTY_ROOT}/SDL_mixer")
add_subdirectory("${MW05_RECOMP_THIRDPARTY_ROOT}/plume")

if (APPLE)
    add_subdirectory("${MW05_RECOMP_THIRDPARTY_ROOT}/MoltenVK")
endif()
